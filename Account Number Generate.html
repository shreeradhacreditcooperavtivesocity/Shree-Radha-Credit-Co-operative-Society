<!DOCTYPE html>
<html lang="hi">
<head>
  <meta charset="UTF-8">
  <title>Account Opening Form ‚Äî Shree Radha Credit Co-operative Society</title>
  <style>
    :root { --maroon:#800000; --light-maroon:#a55252; --paper:#fff; }
    body {
      margin:0; padding:0; background:var(--paper);
      font-family: Arial, Helvetica, sans-serif;
      display:flex; justify-content:center; align-items:flex-start; min-height:100vh;
    }
    .a4 {
      width:600px; margin:18px auto; padding:18px;
      border:1.8px solid var(--maroon);
      box-shadow:0 6px 18px rgba(0,0,0,.06);
      background:#fff; border-radius:12px;
    }
    header {
      display:flex; align-items:center; justify-content:space-between;
      border-bottom:4px solid var(--maroon);
      padding-bottom:10px; margin-bottom:16px;
    }
    .coop h1 { margin:0; font-size:18px; color:var(--maroon); }
    .coop p { margin:2px 0; font-size:12px; }
    .form-row { display:flex; gap:10px; margin-bottom:15px; }
    .form-row.single { flex-direction:column; }
    .form-group { flex:1; }
    label { display:block; font-weight:bold; margin-bottom:5px; color:maroon; font-size:14px; }
    input, select {
      width:100%; padding:8px; font-size:14px;
      border-radius:5px; border:1.5px solid maroon;
      box-sizing:border-box; color:maroon; background:white;
    }
    button {
      padding:8px 12px; border:none;
      font-weight:bold; border-radius:5px; cursor:pointer;
    }
    #submitBtn { width:100%; background-color: maroon; color:white; margin-top:10px; }
    #submitBtn:hover { background-color:#a00000; }
    #copyBtn { background:green; color:white; margin-top:10px; display:none; }
    #successMsg { margin-top:10px; text-align:center; font-weight:bold; color:green; }

    /* Security Modal */
    .overlay {
      position:fixed; inset:0; background:rgba(0,0,0,0.6);
      display:flex; justify-content:center; align-items:center;
      z-index:9999;
    }
    .modal {
      background:#fff; padding:22px; border-radius:10px; width:320px;
      box-shadow:0 8px 30px rgba(0,0,0,0.4); text-align:center;
    }
    .modal h3 { margin-bottom:12px; font-size:18px; color:maroon; }
    .modal input {
      margin-bottom:10px; font-size:16px; padding:10px;
      border:1.5px solid maroon; border-radius:5px; color:maroon;
    }
    .modal button { padding:10px 16px; border-radius:6px; border:none; cursor:pointer; font-weight:600; }
    .btn-verify { background:maroon; color:white; margin-right:8px; }
    .btn-cancel { background:#e0e0e0; color:#333; }

    .denied-screen {
      position:fixed; inset:0; background:#fff;
      display:flex; justify-content:center; align-items:center;
      flex-direction:column; z-index:10000;
    }
    .denied-screen h1 { color:#c62828; font-size:26px; margin-bottom:8px; }
    .denied-screen p { color:#333; }
    .blocked { pointer-events:none; filter:blur(0.2px); }

    @media print {
      .overlay, .denied-screen { display:none !important; }
    }
  </style>
</head>
<body>
  <!-- Security modal -->
  <div id="securityOverlay" class="overlay">
    <div class="modal">
      <h3>üîê Security Code</h3>
      <input id="securityInput" type="password" placeholder="Enter security code" autocomplete="off" />
      <div style="margin-top:8px;">
        <button id="verifyBtn" class="btn-verify">Verify</button>
        <button id="cancelBtn" class="btn-cancel">Cancel</button>
      </div>
      <div id="secMsg" style="margin-top:8px;color:#c62828;font-weight:600;"></div>
    </div>
  </div>

  <!-- Denied screen -->
  <div id="deniedScreen" class="denied-screen" style="display:none;">
    <h1>‚ùå Access Denied</h1>
    <p>Security code ‡§ó‡§≤‡§§ ‡§π‡•à ‚Äî ‡§™‡§π‡•Å‡§Å‡§ö ‡§∞‡•ã‡§ï‡•Ä ‡§ó‡§Ø‡•Ä ‡§π‡•à‡•§</p>
  </div>

  <!-- Main Content -->
  <div id="pageContent" style="display:none;">
    <div class="a4">
      <header>
        <div class="coop">
          <h1>Shree Radha Credit Co-operative Society Limited, Gujri (Dhamnod)</h1>
          <p>Reg. No.: DR/DHR/151716</p>
        </div>
        <div style="text-align:right; font-size:13px; color:var(--maroon)">
          <strong>Account Opening Form</strong>
        </div>
      </header>

      <form id="accountForm">
        <!-- Account Number -->
        <div class="form-row single">
          <div class="form-group">
            <label>Account Number</label>
            <input type="text" id="accountNumber" name="accountNumber" readonly>
          </div>
        </div>

        <!-- Prefix + Name -->
        <div class="form-row">
          <div class="form-group">
            <label for="prefix">Name Prefix</label>
            <select id="prefix" name="prefix" required>
              <option value="">Select</option>
              <option value="Mr.">Mr.</option>
              <option value="Mrs.">Mrs.</option>
            </select>
          </div>
          <div class="form-group">
            <label for="name">Full Name</label>
            <input type="text" id="name" name="name" required>
          </div>
        </div>

        <!-- Aadhaar -->
        <div class="form-row single">
          <div class="form-group">
            <label for="aadhaar">Aadhaar Number</label>
            <input type="text" id="aadhaar" name="aadhaar" pattern="\d{12}" maxlength="12" required>
          </div>
        </div>

        <!-- Submit -->
        <button type="submit" id="submitBtn">Submit</button>
        <button type="button" id="copyBtn">üìã Copy Account Number</button>
        <div id="successMsg"></div>
      </form>
    </div>
  </div>

  <script>
    const SECURITY_CODE = "R@dha9754"; 
    const scriptURL = "https://script.google.com/macros/s/AKfycbw0XCTFcVHuwFFXUN7fK04NIECqC1FT_HPcFPTzaqpwHT16SHGAWeKEiTALZx5-dhoI/exec";

    const overlay=document.getElementById('securityOverlay');
    const secInput=document.getElementById('securityInput');
    const verifyBtn=document.getElementById('verifyBtn');
    const cancelBtn=document.getElementById('cancelBtn');
    const secMsg=document.getElementById('secMsg');
    const deniedScreen=document.getElementById('deniedScreen');
    const pageContent=document.getElementById('pageContent');

    // Security check
    window.addEventListener('load',()=>{
      overlay.style.display='flex';
      secInput.focus();
    });

    verifyBtn.addEventListener('click',tryVerify);
    secInput.addEventListener('keydown',e=>{if(e.key==='Enter') tryVerify();});
    cancelBtn.addEventListener('click',()=>{
      overlay.style.display='none'; pageContent.style.display='none'; deniedScreen.style.display='flex';
    });

    function tryVerify(){
      const val=secInput.value.trim();
      if(!val){ secMsg.textContent='‡§ï‡•É‡§™‡§Ø‡§æ code ‡§¶‡§∞‡•ç‡§ú ‡§ï‡§∞‡•á‡§Ç'; return; }
      if(val===SECURITY_CODE){ 
        overlay.style.display='none'; 
        pageContent.style.display='block'; 
      }
      else { overlay.style.display='none'; pageContent.style.display='none'; deniedScreen.style.display='flex'; }
    }

    // ‡§™‡§π‡§≤‡•á ‡§∏‡•á generated account numbers
    const usedAccounts = [
      "SRC3578","SRC3668","SRC5249","SRC6858","SRC9697","SRC1740","SRC9504",
      "SRC5923","SRC3524","SRC1226","SRC5675","SRC5374","SRC7336","SRC3016",
      "SRC7370","SRC1088","SRC6329","SRC9443","SRC3662","SRC1561","SRC3563",
      "SRC1259","SRC8541","SRC5129","SRC1715","SRC2033"
    ];

    // Unique account number generator
    function generateAccountNumber() {
      const prefix = "SRC";
      let newAcc;
      do {
        const random = Math.floor(1000 + Math.random() * 9000);
        newAcc = prefix + random;
      } while (usedAccounts.includes(newAcc));
      usedAccounts.push(newAcc); 
      return newAcc;
    }
    document.getElementById("accountNumber").value = generateAccountNumber();

    // Form submit
    const form = document.getElementById('accountForm');
    const successMsg = document.getElementById('successMsg');
    const copyBtn=document.getElementById('copyBtn');

    form.addEventListener('submit', e => {
      e.preventDefault();

      const submitBtn = document.getElementById('submitBtn');
      submitBtn.disabled = true;
      submitBtn.textContent = 'Submitting...';

      const formData = new FormData(form);

      fetch(scriptURL, { method: 'POST', body: formData })
      .then(res => res.json())
      .then(resJson => {
        if (resJson.status === "success") {
          successMsg.textContent = "‚úÖ Form submitted successfully! Account Number: "+document.getElementById("accountNumber").value;
          successMsg.style.color = "green";
          copyBtn.style.display="inline-block";
        } else {
          successMsg.textContent = resJson.message;
          successMsg.style.color = "red";
        }
        submitBtn.disabled = false;
        submitBtn.textContent = 'Submit';
      })
      .catch(err => {
        console.error(err);
        successMsg.textContent = "‚ùå Network error ‚Äì please check connection";
        successMsg.style.color = "red";
        submitBtn.disabled = false;
        submitBtn.textContent = 'Submit';
      });
    });

    // Copy button
    copyBtn.addEventListener('click',()=>{
      const accNo=document.getElementById("accountNumber").value;
      navigator.clipboard.writeText(accNo).then(()=>{
        alert("‚úÖ Account Number copied: " + accNo);
        location.reload();
      });
    });
  </script>
</body>
</html>

