<!DOCTYPE html>
<html lang="hi">
<head>
  <meta charset="UTF-8">
  <title>Customer Search Dashboard</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 20px;
    }
    h2 { color: #333; }
    .search-row {
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
      align-items: center;
      margin-bottom: 10px;
    }
    .search-row input {
      padding: 8px;
      width: 200px;
    }
    button {
      padding: 9px 16px;
      background: #007BFF;
      color: white;
      border: none;
      cursor: pointer;
      border-radius: 4px;
    }
    button:hover { background: #0056b3; }
    table {
      border-collapse: collapse;
      margin-top: 20px;
      width: 100%;
    }
    th, td {
      border: 1px solid #999;
      padding: 8px;
      text-align: left;
    }
    th { background: #f2f2f2; }
    .error { color: red; margin-top: 10px; }
    .success { color: green; margin-top: 10px; }
  </style>
</head>
<body>
  <h2>üîç Customer Search Dashboard</h2>

  <div class="search-row">
    <input type="text" id="accountNumber" placeholder="Account Number">
    <input type="text" id="aadhaar" placeholder="Aadhaar Number">
    <input type="text" id="name" placeholder="Name">
    <input type="text" id="mobile" placeholder="Mobile Number">
    <input type="password" id="pin" placeholder="PIN Code">
    <button onclick="searchCustomer()">Search</button>
  </div>

  <div id="message"></div>

  <table id="resultTable" style="display:none;">
    <thead>
      <tr>
        <th>Timestamp</th>
        <th>Account Number</th>
        <th>Name</th>
        <th>Aadhaar</th>
        <th>Mobile</th>
        <th>PIN</th>
      </tr>
    </thead>
    <tbody></tbody>
  </table>

  <script>
    const scriptURL = "https://script.google.com/macros/s/AKfycbw8GqfKsODz0LEH0aj2UFijhZXS49ptOciw0IcKx2qQqsYlrXYhLdkTb0GVK4L9WL4/exec";

    // ‚úÖ Enter ‡§¶‡§¨‡§æ‡§®‡•á ‡§™‡§∞ Search ‡§π‡•ã
    document.addEventListener("keydown", function(event) {
      if (event.key === "Enter") {
        event.preventDefault();
        searchCustomer();
      }
    });

    async function searchCustomer() {
      const accountNumber = document.getElementById("accountNumber").value.trim();
      const aadhaar = document.getElementById("aadhaar").value.trim();
      const name = document.getElementById("name").value.trim();
      const mobile = document.getElementById("mobile").value.trim();
      const pin = document.getElementById("pin").value.trim();

      if (!accountNumber && !aadhaar && !name && !mobile && !pin) {
        document.getElementById("message").innerHTML = '<span class="error">‚ùå ‡§ï‡•É‡§™‡§Ø‡§æ ‡§ï‡•ã‡§à ‡§´‡§º‡•Ä‡§≤‡•ç‡§° ‡§≠‡§∞‡•á‡§Ç‡•§</span>';
        document.getElementById("resultTable").style.display = "none";
        return;
      }

      const params = new URLSearchParams();
      if (accountNumber) params.append("accountNumber", accountNumber);
      if (aadhaar) params.append("aadhaar", aadhaar);
      if (name) params.append("name", name);
      if (mobile) params.append("mobile", mobile);
      if (pin) params.append("pin", pin);

      const url = `${scriptURL}?${params.toString()}`;

      document.getElementById("message").innerHTML = "‚è≥ Searching...";
      document.getElementById("resultTable").style.display = "none";

      try {
        const response = await fetch(url);
        const result = await response.json();

        if (result.status === "success") {
          const data = result.data || [];
          document.getElementById("message").innerHTML = `<span class="success">‚úÖ ${data.length} ‡§∞‡§ø‡§ï‡•â‡§∞‡•ç‡§° ‡§Æ‡§ø‡§≤‡§æ‡•§</span>`;

          const tbody = document.querySelector("#resultTable tbody");
          tbody.innerHTML = "";
          data.forEach(r => {
            tbody.innerHTML += `<tr>
              <td>${r.timestamp}</td>
              <td>${r.accountNumber}</td>
              <td>${r.name}</td>
              <td>${r.aadhaar}</td>
              <td>${r.mobile || '-'}</td>
              <td>${r.pin || '-'}</td>
            </tr>`;
          });

          document.getElementById("resultTable").style.display = data.length > 0 ? "table" : "none";
        } else {
          document.getElementById("message").innerHTML = `<span class="error">${result.message}</span>`;
          document.getElementById("resultTable").style.display = "none";
        }
      } catch (err) {
        document.getElementById("message").innerHTML = `<span class="error">‚ùå Error: ${err}</span>`;
        document.getElementById("resultTable").style.display = "none";
      }
    }
  </script>
</body>
</html>
